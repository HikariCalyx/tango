syntax = "proto3";

package tango.lobby;

message GameInfo {
  message Patch {
    string name = 1;
    string version = 2;
  }
  string rom_name = 1;
  Patch patch = 2;
}

message CreateLobbyRequest {
  string identity_token = 1;
  GameInfo game_info = 2;
  bytes save_data = 3;
}

message CreateLobbyResponse { string lobby_id = 1; }

message JoinIndication {
  string opponent_id = 1;
  GameInfo game_info = 2;
  bytes save_data = 3;
}

message AcceptRequest { string opponent_id = 1; }

message AcceptResponse { string session_id = 1; }

message RejectRequest { string opponent_id = 1; }

message RejectResponse {}

message JoinRequest {
  string lobby_id = 1;
  GameInfo game_info = 2;
  bytes save_data = 3;
}

message JoinResponse {
  GameInfo game_info = 1;
  bytes save_data = 2;
}

message AcceptIndication { string session_id = 1; }

message CreateToServerMessage {
  oneof which {
    CreateLobbyRequest create_lobby_req = 1;
    AcceptRequest accept_req = 2;
    RejectRequest reject_resp = 3;
  }
}

message CreateToClientMessage {
  oneof which {
    CreateLobbyResponse create_lobby_resp = 1;
    JoinIndication join_ind = 2;
    AcceptResponse accept_resp = 3;
    RejectResponse reject_resp = 4;
  }
}

message JoinToServerMessage {
  oneof which { JoinRequest join_req = 1; }
}

message JoinToClientMessage {
  oneof which {
    JoinResponse join_resp = 1;
    AcceptIndication accept_ind = 2;
  }
}
